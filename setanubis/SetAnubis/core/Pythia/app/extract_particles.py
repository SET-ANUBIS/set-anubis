import os
input_filename = filepath = os.path.join(os.path.dirname(__file__),"TestFiles",  "N1_branchingratios.dat")
output_filename = os.path.join(os.path.dirname(__file__),"TestFiles",  "decay_channel.txt")

decay_data = {
    "ds_mu": (431, [9900012, -13]),
    "ds_e": (431, [9900012, -11]),
    "ds_tau": (431, [9900012, -15]),
    "ds_eta_e": (431, [9900012, -11, 221]),
    "ds_eta_mu": (431, [9900012, -13, 221]),
    "lambdac_Lambda0_e": (4122, [9900012, -11, 3122]),
    "lambdac_Lambda0_mu": (4122, [9900012, -13, 3122]),
    "d_mu": (411, [9900012, -13]),
    "d_e": (411, [9900012, -11]),
    "d_tau": (411, [9900012, -15]),
    "d_K0_e": (411, [9900012, -11, -311]),
    "d_K0_mu": (411, [9900012, -13, -311]),
    "d_K*bar0_e": (411, [9900012, -11, -313]),
    "d_K*bar0_mu": (411, [9900012, -13, -313]),
    "lambdab_Lambda_c+_e": (5122, [9900012, 11, 4122]),
    "lambdab_Lambda_c+_mu": (5122, [9900012, 13, 4122]),
    "lambdab_Lambda_c+_tau": (5122, [9900012, 15, 4122]),
    "b_tau": (521, [9900012, -15]),
    "b_mu": (521, [9900012, -13]),
    "b_e": (521, [9900012, -11]),
    "b_D0_bar_e": (521, [9900012, -11, 421]),
    "b_D*0_bar_e": (521, [9900012, -11, 423]),
    "b_D0_bar_mu": (521, [9900012, -13, 421]),
    "b_D*0_bar_mu": (521, [9900012, -13, 423]),
    "b_D0_bar_tau": (521, [9900012, -15, 421]),
    "b_D*0_bar_tau": (521, [9900012, -15, 423]),
    "b_pi0_e": (521, [9900012, -11, 111]),
    "b_pi0_mu": (521, [9900012, -13, 111]),
    "b_pi0_tau": (521, [9900012, -15, 111]),
    "b_rho0_e": (521, [9900012, -11, 113]),
    "b_rho0_mu": (521, [9900012, -13, 113]),
    "b_rho0_tau": (521, [9900012, -15, 113]),
    "Xib_Xi_c+_tau": (5232, [9900012, -15]),
    "Xib_Xi_c+_mu": (5232, [9900012, -13]),
    "Xib_Xi_c+_e": (5232, [9900012, -11]),
    "bs_D_s-_e": (531, [9900012, -11, -431]),
    "bs_D*_s-_e": (531, [9900012, -11, -433]),
    "bs_D_s-_mu": (531, [9900012, -13, -431]),
    "bs_D*_s-_mu": (531, [9900012, -13, -433]),
    "bs_D_s-_tau": (531, [9900012, -15, -431]),
    "bs_D*_s-_tau": (531, [9900012, -15, -433]),
    "bs_K-_e": (531, [9900012, -11, -321]),
    "bs_K-_mu": (531, [9900012, -13, -321]),
    "bs_K-_tau": (531, [9900012, -15, -321]),
    "bs_K*-_e": (531, [9900012, -11, -323]),
    "bs_K*-_mu": (531, [9900012, -13, -323]),
    "bs_K*-_tau": (531, [9900012, -15, -323]),
    "Omega_b-_tau": (5332, [9900012, -15]),
    "Omega_b-_mu": (5332, [9900012, -13]),
    "Omega_b-_e": (5332, [9900012, -11]),
    "b0_D-_e": (511, [9900012, -11, -411]),
    "b0_D*-_e": (511, [9900012, -11, -413]),
    "b0_D-_mu": (511, [9900012, -13, -411]),
    "b0_D*-_mu": (511, [9900012, -13, -413]),
    "b0_D-_tau": (511, [9900012, -15, -411]),
    "b0_D*-_tau": (511, [9900012, -15, -413]),
    "b0_pi-_e": (511, [9900012, -11, -211]),
    "b0_pi-_mu": (511, [9900012, -13, -211]),
    "b0_pi-_tau": (511, [9900012, -15, -211]),
    "b0_rho-_e": (511, [9900012, -11, -213]),
    "b0_rho-_mu": (511, [9900012, -13, -213]),
    "b0_rho-_tau": (511, [9900012, -15, -213]),
     "d0_K-_e": (421, [9900012, -11, -321]),
    "xic0_Xi-_e": (4132, [9900012, -11, 3312]),
    "d0_K*-_e": (421, [9900012, -11, -323]),
    "d0_K-_mu": (421, [9900012, -13, -321]),
    "xic0_Xi-_mu": (4132, [9900012, -13, 3312]),
    "d0_K*-_mu": (421, [9900012, -13, -323]),
    "bc_tau": (541, [9900012, -15]),
    "tau_nu_e_bar_e": (15, [9900012, -11, 12]),
    "tau_nu_mu_bar_mu": (15, [9900012, -13, 14]),
    "tau_nu_tau_e": (15, [9900012, -11, 16]),
    "tau_nu_tau_mu": (15, [9900012, -13, 16]),
    "tau_pi-": (15, [9900012, -211]),
    "tau_K-": (15, [9900012, -321]),
    "tau_rho-": (15, [9900012, -213]),
    "bc_e": (541, [9900012, -11]),
    "bc_B_s0_e": (541, [9900012, -11, 531]),
    "bc_B0_e": (541, [9900012, -11, 511]),
    "bc_B*0_e": (541, [9900012, -11, 513]),
    "bc_B*_s0_e": (541, [9900012, -11, 533]),
    "bc_mu": (541, [9900012, -13]),
    "bc_B_s0_mu": (541, [9900012, -13, 531]),
    "bc_B0_mu": (541, [9900012, -13, 511]),
    "bc_B*0_mu": (541, [9900012, -13, 513]),
    "bc_B*_s0_mu": (541, [9900012, -13, 533])
}

decay_list = []
not_found = []

with open(input_filename, "r") as infile, open(output_filename, "w") as outfile:
    for line in infile:
        line = line.strip()
        if line.startswith("TH1F|"):
            parts = line.split("|")
            if len(parts) >= 2:
                decay_name = parts[1]
                if decay_name in decay_data:
                    mother, daughters = decay_data[decay_name]
                    decay_list.append({"mother": mother, "daughters": daughters})
                else:
                    not_found.append(decay_name)
                    
result = {
    "decay_list": decay_list,
    "not_found": not_found
}
print(result)